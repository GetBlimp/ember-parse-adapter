var EmberParseAdapter={};EmberParseAdapter.Transforms={},EmberParseAdapter.Serializer=DS.RESTSerializer.extend({primaryKey:"objectId",extractArray:function(e,t,r){var a={};return a[Ember.String.pluralize(t.typeKey)]=r.results,this._super(e,t,a)},extractSingle:function(e,t,r,a){var i={};return i[t.typeKey]=r,this._super(e,t,i,a)},typeForRoot:function(e){return Ember.String.dasherize(Ember.String.singularize(e))},extract:function(e,t,r,a,i){return null===a||"updateRecord"!==i&&"deleteRecord"!==i||(r[this.get("primaryKey")]=a),this._super(e,t,r,a,i)},extractMeta:function(e,t,r){r&&r.count&&(e.metaForType(t,{count:r.count}),delete r.count)},normalizeAttributes:function(e,t){e.eachAttribute(function(e,r){"date"===r.type&&"object"===Ember.typeOf(t[e])&&t[e].iso&&(t[e]=t[e].iso)}),this._super(e,t)},normalizeRelationships:function(e,t){var r=this.get("store"),a=this;e.eachRelationship(function(e,i){var n=i.options;t[e]&&"belongsTo"===i.kind&&(t[e]=t[e].objectId),t[e]&&"hasMany"===i.kind&&(n.relation&&(t.links={},t.links[e]={type:i.type,key:e}),n.array&&t[e].length&&t[e]&&t[e].forEach(function(e,t,n){"Pointer"===e.__type?n[t]=e.objectId:(delete e.__type,delete e.className,e.id=e.objectId,delete e.objectId,e.type=i.type,a.normalizeAttributes(i.type,e),a.normalizeRelationships(i.type,e),r.push(i.type,e))}))},this),this._super(e,t)},serializeIntoHash:function(e,t,r,a){Ember.merge(e,this.serialize(r,a))},serializeAttribute:function(e,t,r,a){"createdAt"===r||"updatedAt"===r||"emailVerified"===r||"sessionToken"===r?delete t[r]:this._super(e,t,r,a)},serializeBelongsTo:function(e,t,r){var a=r.key,i=e.get(a);if(i){if(i instanceof DS.PromiseObject){if(!i.get("isFulfilled"))throw Error("belongsTo values *must* be fulfilled before attempting to serialize them");i=i.get("content")}t[a]={__type:"Pointer",className:this.parseClassName(i.constructor.typeKey),objectId:i.get("id")}}},parseClassName:function(e){return"parseUser"===e?"_User":Ember.String.capitalize(Ember.String.camelize(e))},serializeHasMany:function(e,t,r){var a=r.key,i=e.get(a),n=r.options;if(i&&i.get("length")>0){if(t[a]={objects:[]},n.relation&&(t[a].__op="AddRelation"),n.array&&(t[a].__op="AddUnique"),i.forEach(function(e){t[a].objects.push({__type:"Pointer",className:e.parseClassName(),objectId:e.get("id")})}),i._deletedItems&&i._deletedItems.length){if(n.relation){var s=t[a],o={__op:"RemoveRelation",objects:[]};i._deletedItems.forEach(function(e){o.objects.push({__type:"Pointer",className:e.type,objectId:e.id})}),t[a]={__op:"Batch",ops:[s,o]}}n.array&&(t[a].deleteds={__op:"Remove",objects:[]},i._deletedItems.forEach(function(e){t[a].deleteds.objects.push({__type:"Pointer",className:e.type,objectId:e.id})}))}}else t[a]=[]}}),EmberParseAdapter.Adapter=DS.RESTAdapter.extend({defaultSerializer:"-parse",init:function(){this._super(),this.set("headers",{"X-Parse-Application-Id":this.get("applicationId"),"X-Parse-REST-API-Key":this.get("restApiId")})},host:"https://api.parse.com",namespace:"1",classesPath:"classes",pathForType:function(e){return"parseUser"===e?"users":"login"===e?"login":this.classesPath+"/"+this.parsePathForType(e)},parsePathForType:function(e){return Ember.String.capitalize(Ember.String.camelize(e))},createRecord:function(e,t,r){var a={},i=e.serializerFor(t.typeKey);i.serializeIntoHash(a,t,r,{includeId:!0});var n=this;return new Ember.RSVP.Promise(function(e,r){n.ajax(n.buildURL(t.typeKey),"POST",{data:a}).then(function(t){var r=Ember.merge(a,t);e(r)},function(e){r(e.responseJSON)})})},updateRecord:function(e,t,r){var a={},i={},n=!1,s=e.serializerFor(t.typeKey);s.serializeIntoHash(a,t,r);var o=r.get("id"),u=this;return t.eachRelationship(function(e){a[e]&&a[e].deleteds&&(i[e]=a[e].deleteds,delete a[e].deleteds,n=!0)}),new Ember.RSVP.Promise(function(e,r){n?u.ajax(u.buildURL(t.typeKey,o),"PUT",{data:i}).then(function(){u.ajax(u.buildURL(t.typeKey,o),"PUT",{data:a}).then(function(t){var r=Ember.merge(a,t);e(r)},function(e){r("Failed to save parent in relation: "+e.response.JSON)})},function(e){r(e.responseJSON)}):u.ajax(u.buildURL(t.typeKey,o),"PUT",{data:a}).then(function(t){var r=Ember.merge(a,t);e(r)},function(e){r(e.responseJSON)})})},parseClassName:function(e){return Ember.String.capitalize(e)},findHasMany:function(e,t,r){var a={where:{$relatedTo:{object:{__type:"Pointer",className:this.parseClassName(t.typeKey),objectId:t.get("id")},key:r.key}}};return this.ajax(this.buildURL(r.type.typeKey),"GET",{data:a})},sessionToken:Ember.computed("headers.X-Parse-Session-Token",function(e,t){return 2>arguments.length?this.get("headers.X-Parse-Session-Token"):this.set("headers.X-Parse-Session-Token",t)})}),EmberParseAdapter.ParseUser=DS.Model.extend({username:DS.attr("string"),password:DS.attr("string"),email:DS.attr("string"),emailVerified:DS.attr("boolean"),sessionToken:DS.attr("string"),createdAt:DS.attr("date"),updatedAt:DS.attr("date"),logout:function(){this.get("store").adapterFor(this.constructor)},requestPasswordReset:function(e){var t=this.get("store").adapterFor(this.constructor),r={email:this.get("email")};t.ajax(t.buildURL("requestPasswordReset"),"POST",{data:r}).then(function(t){e(t)},function(t){e(t.responseJSON)})}}),EmberParseAdapter.ParseUser.reopenClass({login:function(e,t){if(Ember.isEmpty(this.typeKey))throw Error("Parse login must be called on a model fetched via store.modelFor");var r=this,a=e.adapterFor(r),i=e.serializerFor(r);return a.ajax(a.buildURL("login"),"GET",{data:t}).then(function(t){i.normalize(r,t);var a=e.push(r,t);return a},function(e){return Ember.RSVP.reject(e.responseJSON)})},signup:function(e,t){if(Ember.isEmpty(this.typeKey))throw Error("Parse signup must be called on a model fetched via store.modelFor");var r=this,a=e.adapterFor(r),i=e.serializerFor(r);return a.ajax(a.buildURL(r.typeKey),"POST",{data:t}).then(function(a){i.normalize(r,a),a.email=a.email||t.email,a.username=a.username||t.username;var n=e.push(r,a);return n},function(e){return Ember.RSVP.reject(e.responseJSON)})}}),EmberParseAdapter.GeoPoint=Ember.Object.extend({latitude:Ember.computed(function(){return this._latitude}).readOnly(),longitude:Ember.computed(function(){return this._longitude}).readOnly(),init:function(e,t){this._latitude=e,this._longitude=t}}),EmberParseAdapter.File=Ember.Object.extend({name:Ember.computed(function(){return this._name}).readOnly(),url:Ember.computed(function(){return this._url}).readOnly(),init:function(e,t){this._name=e,this._url=t}}),EmberParseAdapter.Transforms.GeoPoint=DS.Transform.extend({deserialize:function(e){return e?new EmberParseAdapter.GeoPoint(e.latitude,e.longitude):null},serialize:function(e){return e?{__type:"GeoPoint",latitude:e.get("latitude"),longitude:e.get("longitude")}:null}}),EmberParseAdapter.Transforms.File=DS.Transform.extend({deserialize:function(e){return e?new EmberParseAdapter.File(e.name,e.url):null},serialize:function(e){return e?{__type:"File",name:e.get("name"),url:e.get("url")}:null}}),EmberParseAdapter.Transforms.Date=DS.Transform.extend({deserialize:function(e){return e?new Date(e.iso):null},serialize:function(e){return e?{__type:"Date",iso:e.toISOString()}:null}}),EmberParseAdapter.setupContainer=function(e){e.register("adapter:-parse",EmberParseAdapter.Adapter),e.register("serializer:-parse",EmberParseAdapter.Serializer),e.register("model:parse-user",EmberParseAdapter.ParseUser),e.register("transform:parse-geo-point",EmberParseAdapter.Transforms.GeoPoint),e.register("transform:parse-file",EmberParseAdapter.Transforms.File),e.register("transform:parse-date",EmberParseAdapter.Transforms.Date)},Ember.onLoad("Ember.Application",function(e){e.initializer({after:"ember-data",name:"parse-adapter",initialize:function(e){EmberParseAdapter.setupContainer(e)}})});