var ParseAdapter=DS.ParseAdapter=DS.RESTAdapter.extend({defaultSerializer:"Parse",init:function(){this._super(),this.set("headers",{"X-Parse-Application-Id":this.get("applicationId"),"X-Parse-REST-API-Key":this.get("restApiId")})},host:"https://api.parse.com",namespace:"1",classesPath:"classes",pathForType:function(e){var r=this.container.lookupFactory("model:"+e);return DS.ParseUserModel.detect(r)?"users":"login"===e?e:this.classesPath+"/"+r.parseClassName()},updateRecord:function(e,r,t){var s={},a=e.serializerFor(r.typeKey);a.serializeIntoHash(s,r,t);var i=t.get("id"),n=this;return new Ember.RSVP.Promise(function(e,t){n.ajax(n.buildURL(r.typeKey,i),"PUT",{data:s}).then(function(r){var t=Ember.merge(s,r);e(t)},function(e){t(e)})})}});Ember.onLoad("Ember.Application",function(e){e.initializer({name:"parseAdapter",initialize:function(e,r){r.register("adapter:_parse",DS.ParseAdapter)}})});var ParseSerializer=DS.ParseSerializer=DS.RESTSerializer.extend({primaryKey:"objectId",extract:function(e,r,t,s,a){return null!==s&&"updateRecord"===a&&(t[this.get("primaryKey")]=s),this._super(e,r,t,s,a)},normalizeAttributes:function(e,r){e.eachAttribute(function(e,t){"date"===t.type&&"object"===Ember.typeOf(r[e])?r[e]=r[e].iso:"date"===t.type&&"string"===Ember.typeOf(r[e])&&(r[e]=new Date(r[e]).toISOString())}),this._super(e,r)},normalizeRelationships:function(e,r){this._super(e,r),e.eachRelationship(function(t,s){if(r[t]&&"belongsTo"===s.kind&&(r[t]=r[t].objectId),"hasMany"===s.kind){var a={where:{$relatedTo:{object:{__type:"Pointer",className:Ember.String.capitalize(e.parseClassName()),objectId:r.id},key:t}}};r[t]=this.get("store").findQuery(Ember.String.singularize(t),a)}},this)},normalizePayload:function(e,r){var t={};return t[e.typeKey]=r.results?r.results:r,t},serializeIntoHash:function(e,r,t,s){Ember.merge(e,this.serialize(t,s))},serializeAttribute:function(e,r,t,s){"createdAt"===t||"updatedAt"===t||"emailVerified"===t||"sessionToken"===t?delete r[t]:"currentUser"===t?delete r[t]:"date"===s.type&&"createdAt"!==t&&"updatedAt"!==t?r[t]={__type:"Date",iso:e.get(t)}:this._super(e,r,t,s)},serializeBelongsTo:function(e,r,t){var s=t.key,a=e.get(s);if(a){var i=a.parseClassName();r[s]={__type:"Pointer",className:i,objectId:a.get("id")}}},serializeHasMany:function(){}});Ember.onLoad("Ember.Application",function(e){e.initializer({name:"parseSerializer",initialize:function(e,r){r.register("serializer:_parse",DS.ParseSerializer)}})});var ParseModel=DS.ParseModel=DS.Model.extend({createdAt:DS.attr("date"),updatedAt:DS.attr("date"),parseClassName:function(){return this.constructor.parseClassName()}});ParseModel.reopenClass({parseClassName:function(){var e=""+this;return e.split(".").pop()}});var ParseUserModel=DS.ParseUserModel=ParseModel.extend({username:DS.attr("string"),password:DS.attr("string"),email:DS.attr("string"),emailVerified:DS.attr("boolean"),sessionToken:DS.attr("string"),currentUser:DS.attr("boolean"),isCurrent:Ember.computed.bool("currentUser"),logout:function(){var e=this.get("store").adapterFor(this.constructor);this.set("currentUser",!1),this._setCurrent(e,null)},requestPasswordReset:function(e){var r=this.get("store").adapterFor(this.constructor),t={email:this.get("email")};r.ajax(r.buildURL("requestPasswordReset"),"POST",{data:t}).then(function(r){e(r)},function(r){e(r.responseJSON)})},save:function(){if(void 0!==typeof localStorage){var e=JSON.parse(localStorage.getItem("ember_parse_user")),r=this.get("id"),t=this.get("store").adapterFor(this.constructor),s=t.get("headers");r===e.userId&&(s["X-Parse-Session-Token"]=this.get("sessionToken")||e.session,t.set("headers",s))}this._super()},_setCurrent:function(e,r){ParseUserModel._setCurrent(e,r)}});ParseUserModel.reopenClass({_setCurrent:function(e,r){var t=e.get("headers");if(r){if(t["X-Parse-Session-Token"]=r.sessionToken,"undefined"!=typeof localStorage){var s={session:r.sessionToken,userId:r.id};localStorage.setItem("ember_parse_user",JSON.stringify(s))}}else delete t["X-Parse-Session-Token"],"undefined"!=typeof localStorage&&localStorage.removeItem("ember_parse_user");e.set("headers",t)},login:function(e,r){Ember.isEmpty(this.typeKey)&&(this.typeKey=this.parseClassName().toLowerCase());var t=this,s=ParseUserModel.store,a=s.adapterFor(t),i=s.serializerFor(t.typeKey),n={username:e,password:r};return new Ember.RSVP.Promise(function(e,r){a.ajax(a.buildURL("login"),"GET",{data:n}).then(function(r){i.normalizeId(r),r.currentUser=!0,s.push(t.typeKey,r),ParseUserModel._setCurrent(a,r),e(s.find(t.typeKey,r.id))},function(e){ParseUserModel._persist(a,null),r(e.responseJSON)})})},signup:function(e,r,t){Ember.isEmpty(this.typeKey)&&(this.typeKey=this.parseClassName().toLowerCase());var s=this,a=ParseUserModel.store,i=a.adapterFor(s),n=a.serializerFor(s.typeKey),o={username:e,password:r,email:t};return new Ember.RSVP.Promise(function(r,l){i.ajax(i.buildURL(s.typeKey),"POST",{data:o}).then(function(o){n.normalizeId(o),o.currentUser=!0,o.email=t,o.username=e,a.push(s.typeKey,o),ParseUserModel._setCurrent(i,o),r(a.find(s.typeKey,o.id))},function(e){ParseUserModel._persist(i,null),l(e.responseJSON)})})}}),ParseUserModel.reopenClass({parseClassName:function(){return"_User"}}),Ember.onLoad("Ember.Application",function(e){e.initializer({name:"parseUserStore",initialize:function(e){var r=e.lookup("store:main");DS.ParseUserModel.store=r}})});